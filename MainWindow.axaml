<Window x:Class="Weather.Dashboard.Avalonia.MainWindow"
        xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Weather.Dashboard.Avalonia.ViewModels"
        xmlns:models="using:Weather.Dashboard.Avalonia.Models"
        xmlns:controls="using:Weather.Dashboard.Avalonia.Controls"
        x:DataType="vm:MainViewModel"
        Title="Weather Dashboard"
        Width="1300" Height="750"
        FontFamily="Nunito"
        Icon="/Assets/icon.ico"
        MinWidth="900" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource BackgroundBrush}">
<Window.Styles>
    <Style Selector="Border#SearchBorder">
        <Setter Property="Background" Value="{DynamicResource SurfaceVariantBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource OutlineBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="16"/>
        <Setter Property="Padding" Value="6"/>
        <Setter Property="Transitions">
            <Transitions>
                <BrushTransition Property="BorderBrush" Duration="0:0:0.2"/>
                <BrushTransition Property="Background" Duration="0:0:0.2"/>
            </Transitions>
        </Setter>
    </Style>
    
    <Style Selector="Border#SearchBorder:pointerover">
        <Setter Property="BorderBrush" Value="{DynamicResource OnSurfaceBrush}"/>
    </Style>
    
    <Style Selector="Border#SearchBorder:focus-within">
        <Setter Property="BorderBrush" Value="{DynamicResource PrimaryBrush}"/>
        <Setter Property="BorderThickness" Value="2"/>
    </Style>
    
    <Style Selector="TextBox#SearchBox">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Foreground" Value="{DynamicResource OnSurfaceBrush}"/>
        <Setter Property="CaretBrush" Value="{DynamicResource PrimaryBrush}"/>
        <Setter Property="SelectionBrush" Value="{DynamicResource PrimaryContainerBrush}"/>
        <Setter Property="SelectionForegroundBrush" Value="{DynamicResource OnPrimaryContainerBrush}"/>
        <Setter Property="FontSize" Value="15"/>
        <Setter Property="FontWeight" Value="Regular"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="Padding" Value="0,11"/>
        <Setter Property="Transitions">
            <Transitions>
                <BrushTransition Property="Foreground" Duration="0:0:0.15"/>
            </Transitions>
        </Setter>
    </Style>
    
    <Style Selector="TextBox#SearchBox:focus">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Foreground" Value="{DynamicResource OnSurfaceBrush}"/>
    </Style>
    
    <Style Selector="TextBox#SearchBox:pointerover">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Foreground" Value="{DynamicResource OnSurfaceBrush}"/>
    </Style>
    
    <Style Selector="TextBox#SearchBox /template/ Border#PART_BorderElement">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>
    
    <Style Selector="TextBox#SearchBox:focus /template/ Border#PART_BorderElement">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>
    
    <Style Selector="TextBox#SearchBox:pointerover /template/ Border#PART_BorderElement">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>
    
    <Style Selector="TextBox#SearchBox /template/ TextBlock#PART_Watermark">
        <Setter Property="Foreground" Value="{DynamicResource OnSurfaceVariantBrush}"/>
        <Setter Property="Opacity" Value="0.6"/>
        <Setter Property="FontSize" Value="15"/>
        <Setter Property="FontWeight" Value="Regular"/>
    </Style>
    
    <Style Selector="PathIcon.search-icon">
        <Setter Property="Foreground" Value="{DynamicResource OnSurfaceVariantBrush}"/>
        <Setter Property="Width" Value="20"/>
        <Setter Property="Height" Value="20"/>
        <Setter Property="Margin" Value="12,0,10,0"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="Transitions">
            <Transitions>
                <BrushTransition Property="Foreground" Duration="0:0:0.2"/>
            </Transitions>
        </Setter>
    </Style>
    
    <Style Selector="Border#SearchBorder:focus-within PathIcon.search-icon">
        <Setter Property="Foreground" Value="{DynamicResource PrimaryBrush}"/>
    </Style>
    
    <Style Selector="Button.search-clear">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Width" Value="32"/>
        <Setter Property="Height" Value="32"/>
        <Setter Property="CornerRadius" Value="16"/>
        <Setter Property="Margin" Value="6"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="VerticalAlignment" Value="Center"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="Transitions">
            <Transitions>
                <BrushTransition Property="Background" Duration="0:0:0.15"/>
            </Transitions>
        </Setter>
    </Style>
    
    <Style Selector="Button.search-clear:pointerover">
        <Setter Property="Background" Value="{DynamicResource SurfaceVariantBrush}"/>
    </Style>
    
    <Style Selector="Button.search-clear:pressed">
        <Setter Property="Background" Value="{DynamicResource OutlineVariantBrush}"/>
    </Style>
    
    <Style Selector="Button.search-clear PathIcon">
        <Setter Property="Foreground" Value="{DynamicResource OnSurfaceVariantBrush}"/>
        <Setter Property="Width" Value="16"/>
        <Setter Property="Height" Value="16"/>
        <Setter Property="Transitions">
            <Transitions>
                <BrushTransition Property="Foreground" Duration="0:0:0.15"/>
            </Transitions>
        </Setter>
    </Style>
    
    <Style Selector="Button.search-clear:pointerover PathIcon">
        <Setter Property="Foreground" Value="{DynamicResource OnSurfaceBrush}"/>
    </Style>
    
    <Style Selector="Popup#SuggestionsPopup">
        <Setter Property="PlacementMode" Value="Bottom"/>
        <Setter Property="VerticalOffset" Value="8"/>
    </Style>
    
    <Style Selector="Border.suggestions-container">
        <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource OutlineBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="16"/>
        <Setter Property="Padding" Value="8"/>
    </Style>
    
    <Style Selector="Button.suggestion-item">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="CornerRadius" Value="12"/>
        <Setter Property="Padding" Value="16,12"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Margin" Value="0,2"/>
        <Setter Property="Transitions">
            <Transitions>
                <BrushTransition Property="Background" Duration="0:0:0.15"/>
            </Transitions>
        </Setter>
    </Style>
    
    <Style Selector="Button.suggestion-item:pointerover">
        <Setter Property="Background" Value="{DynamicResource SurfaceVariantBrush}"/>
    </Style>
    
    <Style Selector="Button.suggestion-item:pressed">
        <Setter Property="Background" Value="{DynamicResource OutlineVariantBrush}"/>
    </Style>

    <Style Selector="Border#DetailOverlay">
        <Setter Property="Opacity" Value="0"/>
        <Setter Property="IsVisible" Value="False"/>
        <Setter Property="Transitions">
            <Transitions>
                <DoubleTransition Property="Opacity" Duration="0:0:0.3" Easing="CubicEaseOut"/>
            </Transitions>
        </Setter>
    </Style>

    <Style Selector="Border#DetailOverlay.visible">
        <Setter Property="Opacity" Value="1"/>
        <Setter Property="IsVisible" Value="True"/>
    </Style>

    <Style Selector="Border#DetailContainer">
        <Setter Property="RenderTransform" Value="scale(0.95) translateY(20px)"/>
        <Setter Property="Opacity" Value="0"/>
        <Setter Property="Transitions">
            <Transitions>
                <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.35" Easing="CubicEaseOut"/>
                <DoubleTransition Property="Opacity" Duration="0:0:0.3" Easing="CubicEaseOut"/>
            </Transitions>
        </Setter>
    </Style>

    <Style Selector="Border#DetailOverlay.visible Border#DetailContainer">
        <Setter Property="RenderTransform" Value="scale(1) translateY(0px)"/>
        <Setter Property="Opacity" Value="1"/>
    </Style>
</Window.Styles>

    <Design.DataContext>
        <vm:MainViewModel/>
    </Design.DataContext>

    <Grid RowDefinitions="Auto,Auto,*,Auto" Background="{DynamicResource BackgroundBrush}">
        
        <!-- Header -->
        <Border Grid.Row="0"
                Padding="24,18"
                Background="{DynamicResource SurfaceBrush}"
                ZIndex="10">
            <Border.Effect>
                <DropShadowEffect Color="#000000" BlurRadius="8" Opacity="0.08" OffsetY="2"/>
            </Border.Effect>
    
            <Grid ColumnDefinitions="Auto,*,Auto,Auto">
        
                <StackPanel Grid.Column="0" 
                           Orientation="Horizontal" 
                           Spacing="14"
                           Margin="0,0,24,0">
                    <Border Background="{DynamicResource PrimaryBrush}"
                           CornerRadius="12"
                           Width="48"
                           Height="48"
                           Padding="10">
                        <PathIcon Data="{StaticResource IconSunny}"
                                 Foreground="{DynamicResource OnPrimaryBrush}"
                                 Width="28"
                                 Height="28"/>
                    </Border>
            
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock FontSize="24" FontWeight="Bold">
                            <Run Text="Weather" Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <Run Text=" Dashboard" Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </TextBlock>
                
                        <TextBlock Text="{Binding StatusMessage}"
                                  FontSize="11"
                                  Foreground="{DynamicResource PrimaryBrush}"
                                  Margin="0,2,0,0"
                                  IsVisible="{Binding StatusMessage, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                    </StackPanel>
                </StackPanel>

                <Grid Grid.Column="1" VerticalAlignment="Center" Margin="0,0,24,0">
                    <Border x:Name="SearchBorder">
                        <Grid ColumnDefinitions="Auto,*,Auto">
                            <PathIcon Grid.Column="0" 
                                      Classes="search-icon" 
                                      Data="{StaticResource IconSearch}"/>
                            <TextBox Grid.Column="1"
                                     x:Name="SearchBox"
                                     Text="{Binding SearchQuery}"
                                     Watermark="{Binding SearchHintText, FallbackValue='Search cities worldwide or use condition:city (e.g., rainy:tehran)'}"
                                     GotFocus="SearchBox_GotFocus"
                                     LostFocus="SearchBox_LostFocus"/>
                            <Button Grid.Column="2"
                                    Classes="search-clear"
                                    Command="{Binding ClearSearchCommand}"
                                    IsVisible="{Binding SearchQuery, Converter={x:Static ObjectConverters.IsNotNull}}">
                                <PathIcon Data="{StaticResource IconClose}"/>
                            </Button>
                        </Grid>
                    </Border>

                    <Popup x:Name="SuggestionsPopup"
                           PlacementTarget="{Binding #SearchBorder}"
                           IsOpen="{Binding HasSearchResults}"
                           Width="400">
                        <Border Classes="suggestions-container">
                            <Border.Effect>
                                <DropShadowEffect Color="#000000" BlurRadius="24" Opacity="0.12" OffsetY="8"/>
                            </Border.Effect>
                            <ScrollViewer MaxHeight="400" 
                                         VerticalScrollBarVisibility="Auto"
                                         HorizontalScrollBarVisibility="Disabled">
                                <ItemsControl ItemsSource="{Binding SearchResults}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Button Classes="suggestion-item"
                                                   Command="{Binding $parent[Window].((vm:MainViewModel)DataContext).AddCityCommand}"
                                                   CommandParameter="{Binding}">
                                                <Grid ColumnDefinitions="Auto,*,Auto">
                                                    <Border Grid.Column="0"
                                                           Background="{DynamicResource PrimaryContainerBrush}"
                                                           CornerRadius="10"
                                                           Width="40" Height="40"
                                                           Padding="8"
                                                           Margin="0,0,12,0">
                                                        <PathIcon Data="{StaticResource IconLocation}"
                                                                 Foreground="{DynamicResource PrimaryBrush}"
                                                                 Width="24" Height="24"/>
                                                    </Border>
                                    
                                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding Name}"
                                                                  FontSize="15"
                                                                  FontWeight="SemiBold"
                                                                  Foreground="{DynamicResource OnSurfaceBrush}"/>
                                                        <TextBlock Text="{Binding Country}"
                                                                  FontSize="13"
                                                                  Foreground="{DynamicResource OnSurfaceVariantBrush}"
                                                                  Margin="0,2,0,0"/>
                                                    </StackPanel>
                                    
                                                    <PathIcon Grid.Column="2"
                                                             Data="{StaticResource IconAdd}"
                                                             Foreground="{DynamicResource PrimaryBrush}"
                                                             Width="20" Height="20"/>
                                                </Grid>
                                            </Button>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Border>
                    </Popup>
                </Grid>

                <Button Grid.Column="2"
                       Command="{Binding RefreshAllCommand}"
                       Width="44"
                       Height="44"
                       Margin="0,0,8,0"
                       Classes="icon"
                       ToolTip.Tip="Refresh all cities">
                    <PathIcon Data="{StaticResource IconRefresh}"
                              Foreground="{DynamicResource TextPrimaryBrush}"
                             Width="22"
                             Height="22"/>
                </Button>
        
            </Grid>
        </Border>
<!-- Weather Filter Bar -->
        <Border Grid.Row="1"
                Background="{DynamicResource SurfaceBrush}"
                BorderBrush="{DynamicResource OutlineVariantBrush}"
                BorderThickness="0,0,0,1"
                Padding="24,12">
            <ScrollViewer HorizontalScrollBarVisibility="Auto" 
                          VerticalScrollBarVisibility="Disabled">
                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                    
                    <!-- All Filter -->
                    <Button Classes="filter-chip"
                            Classes.active="{Binding SelectedFilter, Converter={x:Static ObjectConverters.IsNull}}"
                            Command="{Binding SetFilterCommand}"
                            CommandParameter="{x:Null}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource IconLocation}" Width="16" Height="16"/>
                            <TextBlock Text="All" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Sunny Filter -->
                    <Button Classes="filter-chip filter-sunny"
                            Classes.active="{Binding SelectedFilter, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static models:WeatherCondition.Sunny}}"
                            Command="{Binding SetFilterCommand}">
                        <Button.CommandParameter>
                            <models:WeatherCondition>Sunny</models:WeatherCondition>
                        </Button.CommandParameter>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource IconSunny}" Width="16" Height="16"/>
                            <TextBlock Text="Sunny" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Cloudy Filter -->
                    <Button Classes="filter-chip filter-cloudy"
                            Classes.active="{Binding SelectedFilter, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static models:WeatherCondition.Cloudy}}"
                            Command="{Binding SetFilterCommand}">
                        <Button.CommandParameter>
                            <models:WeatherCondition>Cloudy</models:WeatherCondition>
                        </Button.CommandParameter>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource IconCloudy}" Width="16" Height="16"/>
                            <TextBlock Text="Cloudy" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Rainy Filter -->
                    <Button Classes="filter-chip filter-rainy"
                            Classes.active="{Binding SelectedFilter, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static models:WeatherCondition.Rainy}}"
                            Command="{Binding SetFilterCommand}">
                        <Button.CommandParameter>
                            <models:WeatherCondition>Rainy</models:WeatherCondition>
                        </Button.CommandParameter>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource IconRainy}" Width="16" Height="16"/>
                            <TextBlock Text="Rainy" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Snowy Filter -->
                    <Button Classes="filter-chip filter-snowy"
                            Classes.active="{Binding SelectedFilter, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static models:WeatherCondition.Snowy}}"
                            Command="{Binding SetFilterCommand}">
                        <Button.CommandParameter>
                            <models:WeatherCondition>Snowy</models:WeatherCondition>
                        </Button.CommandParameter>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource IconSnowy}" Width="16" Height="16"/>
                            <TextBlock Text="Snowy" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Storm Filter -->
                    <Button Classes="filter-chip filter-storm"
                            Classes.active="{Binding SelectedFilter, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static models:WeatherCondition.Storm}}"
                            Command="{Binding SetFilterCommand}">
                        <Button.CommandParameter>
                            <models:WeatherCondition>Storm</models:WeatherCondition>
                        </Button.CommandParameter>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource IconStorm}" Width="16" Height="16"/>
                            <TextBlock Text="Storm" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Partly Cloudy Filter -->
                    <Button Classes="filter-chip filter-partly"
                            Classes.active="{Binding SelectedFilter, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static models:WeatherCondition.PartlyCloudy}}"
                            Command="{Binding SetFilterCommand}">
                        <Button.CommandParameter>
                            <models:WeatherCondition>PartlyCloudy</models:WeatherCondition>
                        </Button.CommandParameter>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource IconSunny}" Width="16" Height="16"/>
                            <TextBlock Text="Partly Cloudy" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                    <!-- Foggy Filter -->
                    <Button Classes="filter-chip filter-foggy"
                            Classes.active="{Binding SelectedFilter, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static models:WeatherCondition.Foggy}}"
                            Command="{Binding SetFilterCommand}">
                        <Button.CommandParameter>
                            <models:WeatherCondition>Foggy</models:WeatherCondition>
                        </Button.CommandParameter>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource IconFoggy}" Width="16" Height="16"/>
                            <TextBlock Text="Foggy" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>

                </StackPanel>
            </ScrollViewer>
        </Border>
        <!-- Main Content Area with Cards Grid -->
        <Grid Grid.Row="2">
            
            <!-- Empty State -->
            <Border VerticalAlignment="Center"
                   HorizontalAlignment="Center"
                   IsVisible="{Binding !Favorites.Count}">
                <StackPanel Spacing="24">
                    <Border Background="{DynamicResource SurfaceVariantBrush}"
                           CornerRadius="60"
                           Width="120" Height="120"
                           Padding="30">
                        <PathIcon Data="{StaticResource IconLocation}"
                                 Foreground="{DynamicResource TextSecondaryBrush}"
                                 Opacity="0.3"/>
                    </Border>
                    <StackPanel Spacing="8">
                        <TextBlock Text="No cities added yet"
                                  FontSize="20"
                                  FontWeight="Bold"
                                  Foreground="{DynamicResource TextPrimaryBrush}"
                                  HorizontalAlignment="Center"/>
                        <TextBlock Text="Search for cities above to track their weather"
                                  FontSize="14"
                                  Foreground="{DynamicResource TextSecondaryBrush}"
                                  HorizontalAlignment="Center"
                                  TextAlignment="Center"
                                  MaxWidth="300"
                                  TextWrapping="Wrap"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Cards Grid View -->
            <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                         IsVisible="{Binding SelectedCity, Converter={x:Static ObjectConverters.IsNull}}">
                <ItemsControl ItemsSource="{Binding FilteredFavorites}" Margin="24,20">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel HorizontalAlignment="Center"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <controls:CityWeatherCard Width="380" Height="260" Margin="12"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <!-- ✅ DetailView Fullscreen Glassmorphism Overlay -->
            <Border x:Name="DetailOverlay"
                    Classes.visible="{Binding SelectedCity, Converter={x:Static ObjectConverters.IsNotNull}}"
                    Background="#80000000"
                    ClipToBounds="True"
                    ZIndex="0">
                
                <!-- Glassmorphism Container -->
                <Border x:Name="DetailContainer"
                        Background="#F2FFFFFF"
                        CornerRadius="0"
                        Margin="0"
                        ClipToBounds="True">

                    <!-- Actual DetailView Content -->
                    <controls:DetailView DataContext="{Binding SelectedCity}" ZIndex="100"/>
                </Border>
            </Border>

        </Grid>

        <!-- Footer -->
        <Border Grid.Row="3"
               Padding="20,14"
               Background="{DynamicResource SurfaceBrush}"
               BorderBrush="{DynamicResource OutlineBrush}"
               BorderThickness="0,1,0,0"
               ZIndex="10">
            <Grid ColumnDefinitions="*,Auto,*">
                
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                    <Border Background="{DynamicResource SurfaceVariantBrush}"
                           CornerRadius="6" Padding="6">
                        <PathIcon Data="{StaticResource IconRefresh}"
                                  Foreground="{DynamicResource TextSecondaryBrush}"
                                 Width="14" Height="14"/>
                    </Border>
                    <TextBlock Text="{Binding LastUpdateTime, StringFormat='Last update: {0:HH:mm:ss}'}"
                              Foreground="{DynamicResource TextSecondaryBrush}"
                              FontSize="12"
                              VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CurrentPeriod, StringFormat='Current period: {0}'}"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               FontSize="12"
                               VerticalAlignment="Center"/>
                </StackPanel>
                
                <Border Grid.Column="1"
                       Background="{DynamicResource PrimaryBrush}"
                       CornerRadius="12" Padding="16,6">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource IconLocation}"
                                 Foreground="White" Width="14" Height="14"/>
                        <TextBlock Text="{Binding Favorites.Count, StringFormat='{}{0} cities tracked'}"
                                  Foreground="White"
                                  FontSize="12"
                                  FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>

                <StackPanel Grid.Column="2"
            Orientation="Horizontal"
            HorizontalAlignment="Right"
            Spacing="8">

    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
        <TextBlock Text="Powered by "
                   Foreground="{DynamicResource TextSecondaryBrush}"
                   FontSize="12"/>

        <!-- لینک کلیک‌پذیر -->
        <Border Cursor="Hand"
                Background="Transparent"
                PointerPressed="LumoraFlow_Click">
            <TextBlock Text="Lumora Flow"
                       Foreground="{DynamicResource PrimaryBrush}"
                       FontSize="12"
                       FontWeight="SemiBold"/>
        </Border>
    </StackPanel>

    <Border Background="{DynamicResource SurfaceVariantBrush}"
            CornerRadius="6" Padding="6">
        <PathIcon Data="{StaticResource IconSunny}"
                  Foreground="{DynamicResource PrimaryBrush}"
                  Width="14" Height="14"/>
    </Border>
</StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>